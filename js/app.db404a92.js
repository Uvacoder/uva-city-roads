(function(e){function t(t){for(var o,a,s=t[0],c=t[1],u=t[2],d=0,h=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&h.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"20fa":function(e,t,n){},"30c5":function(e,t,n){"use strict";n("b0c0");var o=t.place={};o.read=function(e,t){return e.readFields(o._readField,{version:0,name:"",date:"",id:"",nodes:[],ways:[]},t)},o._readField=function(e,t,n){1===e?t.version=n.readVarint():2===e?t.name=n.readString():3===e?t.date=n.readString():4===e?t.id=n.readString():5===e?t.nodes.push(o.node.read(n,n.readVarint()+n.pos)):6===e&&t.ways.push(o.way.read(n,n.readVarint()+n.pos))},o.write=function(e,t){if(e.version&&t.writeVarintField(1,e.version),e.name&&t.writeStringField(2,e.name),e.date&&t.writeStringField(3,e.date),e.id&&t.writeStringField(4,e.id),e.nodes)for(var n=0;n<e.nodes.length;n++)t.writeMessage(5,o.node.write,e.nodes[n]);if(e.ways)for(n=0;n<e.ways.length;n++)t.writeMessage(6,o.way.write,e.ways[n])},o.node={},o.node.read=function(e,t){return e.readFields(o.node._readField,{id:0,lat:0,lon:0},t)},o.node._readField=function(e,t,n){1===e?t.id=n.readVarint():2===e?t.lat=n.readFloat():3===e&&(t.lon=n.readFloat())},o.node.write=function(e,t){e.id&&t.writeVarintField(1,e.id),e.lat&&t.writeFloatField(2,e.lat),e.lon&&t.writeFloatField(3,e.lon)},o.way={},o.way.read=function(e,t){return e.readFields(o.way._readField,{nodes:[]},t)},o.way._readField=function(e,t,n){1===e&&n.readPackedVarint(t.nodes)},o.way.write=function(e,t){e.nodes&&t.writePackedVarint(1,e.nodes)}},"46e8":function(e,t,n){"use strict";n("93cf")},"4eab":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("99af");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.placeFound?e._e():n("find-place",{on:{loaded:e.onGridLoaded}}),n("div",{attrs:{id:"app"}},[e.placeFound?n("div",[n("div",{staticClass:"controls"},[n("a",{staticClass:"print-button",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.toggleSettings(t)}}},[e._v("Customize...")]),n("a",{staticClass:"try-another",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.startOver(t)}}},[e._v("Try another city")])]),e.showSettings?n("div",{staticClass:"print-window"},[n("h3",[e._v("Display")]),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[e._v("Colors")]),n("div",{staticClass:"col colors c-2"},e._l(e.layers,(function(t){return n("div",{key:t.name,staticClass:"color-container"},[n("color-picker",{on:{change:t.changeColor},model:{value:t.color,callback:function(n){e.$set(t,"color",n)},expression:"layer.color"}}),n("div",{staticClass:"color-label"},[e._v(e._s(t.name))])],1)})),0)]),n("h3",[e._v("Export")]),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.zazzleMugPrint()}}},[e._v("Onto a mug")]),e._m(0)]),e.zazzleLink||e.generatingPreview?n("div",{staticClass:"preview-actions message"},[e.zazzleLink?n("div",{staticClass:"padded popup-help"},[e._v(" If your browser has blocked the new window, "),n("br"),e._v("please "),n("a",{attrs:{href:e.zazzleLink,target:"_blank"}},[e._v("click here")]),e._v(" to open it. ")]):e._e(),e.generatingPreview?n("div",{staticClass:"loading-container"},[n("loading-icon"),e._v(" Generating preview url... ")],1):e._e()]):e._e(),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.toPNGFile(t)}}},[e._v("As an image (.png)")]),n("span",{staticClass:"col c-2"},[e._v(" Save the current screen as a raster image. ")])]),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.toSVGFile(t)}}},[e._v("As a vector (.svg)")]),n("span",{staticClass:"col c-2"},[e._v(" Save the current screen as a vector image. ")])]),e._e(),n("h3",[e._v("About")]),e._m(1)]):e._e()]):e._e()]),e.placeFound?n("editable-label",{staticClass:"city-name",style:{color:e.labelColorRGBA},attrs:{printable:!0,"overlay-manager":e.overlayManager},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}):e._e(),e.placeFound?n("div",{staticClass:"license printable can-drag",style:{color:e.labelColorRGBA}},[e._v("data "),n("a",{style:{color:e.labelColorRGBA},attrs:{href:"https://www.openstreetmap.org/about/",target:"_blank"}},[e._v("© OpenStreetMap")])]):e._e()],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"col c-2"},[e._v(" Print what you see onto a mug. "),n("br"),e._v("Get a unique gift of your favorite city. ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("This website was created by "),n("a",{attrs:{href:"https://twitter.com/anvaka",target:"_blank"}},[e._v("@anvaka")]),e._v(". It downloads roads from OpenStreetMap and renders them with WebGL. ")]),n("p",[e._v(" You can find the entire "),n("a",{attrs:{href:"https://github.com/anvaka/city-roads"}},[e._v("source code here")]),e._v(". If you love this website you can also "),n("a",{attrs:{href:"https://www.paypal.com/paypalme2/anvakos/3"}},[e._v("buy me a coffee")]),e._v(" or "),n("a",{attrs:{href:"https://www.patreon.com/anvaka"}},[e._v("support me on Patreon")]),e._v(", but you don't have to. ")])])}],a=n("d4ec"),s=(n("b0c0"),n("ac1f"),n("1276"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"find-place",class:{centered:e.boxInTheMiddle}},[e.boxInTheMiddle?n("div",[n("h3",{staticClass:"site-header"},[e._v("city roads")]),n("p",{staticClass:"description"},[e._v("This website renders every single road within a city")])]):e._e(),n("form",{staticClass:"search-box",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.enteredInput,expression:"enteredInput"}],ref:"input",staticClass:"query-input",attrs:{type:"text",placeholder:"Enter a city name to start"},domProps:{value:e.enteredInput},on:{input:function(t){t.target.composing||(e.enteredInput=t.target.value)}}}),e.enteredInput&&!e.hideInput?n("a",{staticClass:"search-submit",attrs:{type:"submit",href:"#"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v(e._s(e.mainActionText))]):e._e()]),e.showWarning?n("div",{staticClass:"prompt message note shadow"},[e._v(" Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render. ")]):e._e(),e.loading?e._e():n("div",{staticClass:"results"},[e.suggestionsLoaded&&e.suggestions.length?n("div",{staticClass:"suggestions shadow"},[e._m(0),n("ul",e._l(e.suggestions,(function(t,o){return n("li",{key:o},[n("a",{staticClass:"suggestion",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),e.pickSuggestion(t)}}},[n("span",[e._v(" "+e._s(t.name)+" "),n("small",[e._v("("+e._s(t.type)+")")])])])])})),0)]):e._e(),!e.suggestionsLoaded||e.suggestions.length||e.loading||e.error?e._e():n("div",{staticClass:"no-results message shadow"},[e._v(" Didn't find matching cities. Try a different query? ")]),e.noRoads?n("div",{staticClass:"no-results message shadow"},[e._v(" Didn't find any roads. Try a different query? ")]):e._e()]),e.error?n("div",{staticClass:"error message shadow"},[n("div",[e._v("Sorry, we were not able to download data from the OpenStreetMap. It could be very busy at the moment processing other requests. "),n("br"),n("br"),e._v(" Please bookmark this website and "),n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.retry(t)}}},[e._v("try again")]),e._v(" later?")]),n("div",{staticClass:"error-links"},[n("a",{attrs:{href:"https://twitter.com/anvaka/status/1218971717734789120",title:"see what it supposed to do",target:"_blank"}},[e._v("see how it should have worked")]),n("a",{attrs:{href:e.getBugReportURL(e.error),title:"report error: "+e.error,target:"_blank"}},[e._v("report this bug")])])]):e._e(),e.loading?n("div",{staticClass:"loading message shadow"},[n("loading-icon"),n("span",[e._v(e._s(e.loading))]),n("a",{staticClass:"cancel-request",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.cancelRequest(t)}}},[e._v("cancel")]),e.stillLoading>0?n("div",{staticClass:"load-padding"},[e._v(" Still loading... ")]):e._e(),e.stillLoading>1?n("div",{staticClass:"load-padding"},[e._v(" Sorry it takes so long! ")]):e._e()],1):e._e()])}),c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"prompt message"},[n("div",[e._v("Select boundaries below to download all roads within")]),n("div",{staticClass:"note"},[e._v("large cities may require 200MB+ of data transfer and a powerful device")])])}],u=(n("d3b7"),n("25f0"),n("ace4"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("a15b"),n("f00c"),n("a9e3"),n("5319"),n("25eb"),n("4de4"),n("d81d"),n("c35a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticClass:"loader",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"12",height:"12",fill:"black"}},[n("path",{attrs:{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}}),n("path",{attrs:{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}},[n("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"0.8s",repeatCount:"indefinite"}})],1)])}),l=[],d=n("2877"),h={},f=Object(d["a"])(h,u,l,!1,null,null,null),p=f.exports,g=n("bee2"),v=n("ade3"),m=(n("466d"),n("b64b"),n("00c7")),b=n.n(m),y=function(){function e(t){Object(a["a"])(this,e),b()(this),this.callback=t||Function.prototype}return Object(g["a"])(e,[{key:"cancel",value:function(){this.isCancelled=!0,this.fire("cancel")}},{key:"notify",value:function(e){this.isCancelled||this.callback(e)}},{key:"onCancel",value:function(e){this.on("cancel",e,this)}},{key:"offCancel",value:function(e){this.off("cancel",e)}}]),e}();function w(e,t){var n;t||(t={});var o=t.progress||new y;return o.on&&o.onCancel(r),new Promise(i);function r(){!0,n&&n.abort()}function i(i,a){function s(e){e.lengthComputable?o.notify({loaded:e.loaded,total:e.total,percent:e.loaded/e.total,lengthComputable:!0}):o.notify({loaded:e.loaded,lengthComputable:!1})}function c(){if(o.offCancel(r),!o.isCancelled)if(200===n.status){var s=n.response;"json"===t.responseType&&"string"===typeof s&&(s=JSON.parse(s)),setTimeout((function(){return i(s)}),0)}else a({statusError:n.status,message:"Unexpected status code ".concat(n.status," when calling ").concat(e)})}function u(){a("Failed to download ".concat(e))}function l(){a({cancelled:!0,message:"Cancelled download of ".concat(e)})}n=new XMLHttpRequest,"function"===typeof o.notify&&n.addEventListener("progress",s,!1),n.addEventListener("load",c,!1),n.addEventListener("error",u,!1),n.addEventListener("abort",l,!1),n.open(t.method||"GET",e),t.responseType&&(n.responseType=t.responseType),t.headers&&Object.keys(t.headers).forEach((function(e){n.setRequestHeader(e,t.headers[e])})),"POST"===t.method?n.send(t.body):n.send(null)}}var k=["https://overpass.kumi.systems/api/interpreter","https://overpass-api.de/api/interpreter","https://overpass.openstreetmap.ru/cgi/interpreter"];function x(e,t){t=t||new y;var n={method:"POST",responseType:"json",progress:t,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"data="+encodeURIComponent(e)},o=0;return r(k[o]);function r(e){return w(e,n,"POST").catch(i)}function i(e){if(e.cancelled)throw e;if(o>=k.length-1)throw e;return e.statusError&&t.notify({loaded:-1}),o+=1,r(k[o])}}n("4ec9"),n("3ca3"),n("ddb0");var _=function(){function e(){Object(a["a"])(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}return Object(g["a"])(e,[{key:"growBy",value:function(e){this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e}},{key:"left",get:function(){return this.minX}},{key:"top",get:function(){return this.minY}},{key:"right",get:function(){return this.maxX}},{key:"bottom",get:function(){return this.maxY}},{key:"width",get:function(){return this.maxX-this.minX}},{key:"height",get:function(){return this.maxY-this.minY}},{key:"cx",get:function(){return(this.minX+this.maxX)/2}},{key:"cy",get:function(){return(this.minY+this.maxY)/2}},{key:"addPoint",value:function(e,t){if(void 0===e)throw new Error("Point is not defined");var n=e,o=t;void 0===o&&(n=e.x,o=e.y),n<this.minX&&(this.minX=n),n>this.maxX&&(this.maxX=n),o<this.minY&&(this.minY=o),o>this.maxY&&(this.maxY=o)}},{key:"addRect",value:function(e){if(!e)throw new Error("rect is not defined");this.addPoint(e.left,e.top),this.addPoint(e.right,e.top),this.addPoint(e.left,e.bottom),this.addPoint(e.right,e.bottom)}},{key:"merge",value:function(e){e.minX<this.minX&&(this.minX=e.minX),e.minY<this.minY&&(this.minY=e.minY),e.maxX>this.maxX&&(this.maxX=e.maxX),e.maxY>this.maxY&&(this.maxY=e.maxY)}}]),e}(),C=n("2d9e"),L=function(){function e(){Object(a["a"])(this,e),this.elements=[],this.bounds=new _,this.nodes=new Map,this.wayPointCount=0,this.id=0,this.name="",this.isArea=!0,this.projector=void 0}return Object(g["a"])(e,[{key:"setName",value:function(e){this.name=e}},{key:"setId",value:function(e){this.id=e}},{key:"setIsArea",value:function(e){this.isArea=e}},{key:"setBBox",value:function(e){this.bboxString=e}},{key:"hasRoads",value:function(){return this.wayPointCount>0}},{key:"setProjector",value:function(e){this.projector=e}},{key:"getProjectedRect",value:function(){var e=this.bounds,t=this.getProjector(),n=t({lon:e.left,lat:e.bottom}),o=t({lon:e.right,lat:e.top}),r=n.x,i=n.y,a=o.y,s=o.x;return{left:r,top:i,right:s,bottom:a,width:s-r,height:Math.abs(a-i)}}},{key:"forEachElement",value:function(e){this.elements.forEach(e)}},{key:"forEachWay",value:function(e,t,n){var o=this.nodes,r=this.getProjector();this.elements.forEach((function(i){if("way"===i.type){var a=i.nodes,s=o.get(a[0]);if(s){var c=r(s);t&&t(i);for(var u=1;u<a.length;++u)if(s=o.get(a[u]),s){var l=r(s);e(c,l),c=l}n&&n(i)}}}))}},{key:"getProjector",value:function(){var e=[0,0];this.projector||(this.projector=Object(C["a"])(),this.projector.center([this.bounds.cx,this.bounds.cy]).scale(6371393));var t=this.projector;return n;function n(n){var o=n.lon,r=n.lat;e[0]=o,e[1]=r;var i=t(e);return{x:i[0],y:-i[1]}}}}],[{key:"fromPBF",value:function(t){if(1!==t.version)throw new Error("Unknown version "+t.version);var n=[];t.nodes.forEach((function(e){e.type="node",n.push(e)})),t.ways.forEach((function(e){e.type="way",n.push(e)}));var o=e.fromOSMResponse(n);return o.setName(t.name),o.setId(t.id),o}},{key:"fromOSMResponse",value:function(t){var n=new e,o=n.nodes,r=n.bounds,i=0;return t.forEach((function(e){"node"===e.type?(o.set(e.id,e),r.addPoint(e.lon,e.lat)):"way"===e.type&&(i+=e.nodes.length)})),n.elements=t,n.wayPointCount=i,n}}]),e}(),S=new Map;function F(e){var t=S.get(e);if(t)return Promise.resolve(t);var n=encodeURIComponent(e);return w("https://nominatim.openstreetmap.org/search?format=json&q=".concat(n),{responseType:"json"}).then(E).then((function(t){return S.set(e,t),t}))}function E(e){var t=e.map((function(e){var t,n;return"relation"===e.osm_type?t=e.osm_id+36e8:"way"===e.osm_type&&(t=e.osm_id+24e8),e.boundingbox&&(n=[Number.parseFloat(e.boundingbox[0]),Number.parseFloat(e.boundingbox[2]),Number.parseFloat(e.boundingbox[1]),Number.parseFloat(e.boundingbox[3])]),{areaId:t,bbox:n,lat:e.lat,lon:e.lon,osmId:e.osm_id,osmType:e.osm_type,name:e.display_name,type:e.type}}));return t}var T=function(){function e(t,n){Object(a["a"])(this,e),this.queryBounds=t.bounds,this.queryString=t.queryString,this.progress=n,this.promise=null}return Object(g["a"])(e,[{key:"run",value:function(){var e=this;if(this.promise)return this.promise;var t=O(this.queryString);return this.promise=P(t).then((function(t){return x(t,e.progress)})).then((function(t){var n=L.fromOSMResponse(t.elements);return n.queryBounds=e.queryBounds,n})),this.promise}}],[{key:"runFromOptions",value:function(t,n){return t.getQueryTemplate().then((function(t){var o=new e(t,n);return o.run()}))}}]),e}();function P(e){var t=0;return o().then(n);function n(){return e.map((function(e){return"string"===typeof e?e:"Area"===e.geoType?"area(".concat(e.areaId,")"):"Coords"===e.geoType?e.lat+","+e.lon:"Id"===e.geoType?"".concat(e.osmType,"(").concat(e.osmId,")"):"Bbox"===e.geoType?e.bbox.join(","):void 0})).join("")}function o(){if(t>=e.length)return Promise.resolve();var n=e[t];return t+=1,"string"===typeof n?o():F(n.name).then(I).then((function(e){if(!e)throw new Error("No areas found for request "+n.name);Object.assign(n,e)})).then(j(1e3)).then(o)}}function I(e){if(e.length>0)return e[0]}function O(e){var t,n=/{{geocode(.+?):(.+?)}}/,o=[];while(t=e.match(n))o.push(e.substr(0,t.index)),o.push({geoType:t[1],name:t[2]}),e=e.substr(t.index+t[0].length);return o.push(e),o}function j(e){return function(t){return new Promise((function(n){setTimeout((function(){return n(t)}),e)}))}}Object(v["a"])(T,"All","way"),Object(v["a"])(T,"Building","way[building]"),Object(v["a"])(T,"Road","way[highway]"),Object(v["a"])(T,"RoadBasic",'way[highway~"^(motorway|primary|secondary|tertiary)|residential"]'),Object(v["a"])(T,"RoadStrict",'way[highway~"^(((motorway|trunk|primary|secondary|tertiary)(_link)?)|unclassified|residential|living_street|pedestrian|service|track)$"][area!=yes]');var B=n("9cf4"),R=n.n(B),z=R()({},{useSearch:!0}),A={isCacheEnabled:function(){return 0!=z.get("cache")},enableCache:function(){return z.unset("cache")},get:function(){return z.get.apply(z,arguments)},set:function(){return z.set.apply(z,arguments)},unset:function(){return z.unset.apply(z,arguments)},unsetPlace:function(){z.unset("areaId"),z.unset("osm_id"),z.unset("bbox")}},M=n("66cb"),q=n.n(M),N={areaServer:"https://city-roads.s3-us-west-2.amazonaws.com/nov-02-2020",getDefaultLineColor:function(){return q()("rgba(26, 26, 26, 0.8)")},getLabelColor:function(){return q()("#161616")},getBackgroundColor:function(){return q()("#F7F2E8")}},D=function(){function e(t){Object(a["a"])(this,e),this.place=void 0,this.projector=void 0,this.wayFilter=void 0,this.timeout=900,this.maxHeapByteSize=1073741824,this.outputMethod="skel",Object.assign(this,t)}return Object(g["a"])(e,[{key:"getQueryTemplate",value:function(){var e=this;if(this.raw)return Promise.resolve({queryString:this.raw});if(!this.wayFilter)throw new Error("Way filter is required");return this.getBounds().then((function(t){var n;if(t.areaId)n="[timeout:".concat(e.timeout,"][maxsize:").concat(e.maxHeapByteSize,"][out:json];\narea(").concat(t.areaId,");\n(._; )->.area;\n(").concat(e.wayFilter,"(area.area); node(w););\nout ").concat(e.outputMethod,";");else if(t.bbox){var o=U(t.bbox);n="[timeout:".concat(e.timeout,"][maxsize:").concat(e.maxHeapByteSize,"][bbox:").concat(o,"][out:json];\n(").concat(e.wayFilter,"; node(w););\nout ").concat(e.outputMethod,";")}return{bounds:t,queryString:n}}))}},{key:"getBounds",value:function(){if(this.place)return F(this.place).then((function(e){return e&&e[0]}));if(this.areaId)return Promise.resolve({areaId:this.areaId});if(this.bbox)return Promise.resolve({bbox:this.bbox});throw new Error("Please specify bounding area for the query (place|areaId|bbox)")}}],[{key:"parse",value:function(t,n,o){var r=new e;if("string"===typeof o&&(r.place=o),n&&(r.wayFilter=n),!o)return r;Object.assign(r,o);var i=G(t,o.layer);if(i){r.projector=i.getGridProjector();var a=i.getQueryBounds();!a||r.place||r.areaId||r.bbox||(r.place=a.place,r.areaId=a.areaId,r.bbox=a.bbox)}return o.projector&&(r.projector=projector),r}}]),e}();function G(e,t){if(void 0!==t){if("number"===typeof t){var n=e.queryLayerAll();return n[t]}return"string"===typeof t?e.queryLayer(t):t}}function U(e){return e&&e.join(",")}var X="Find City Bounds",Y={name:"FindPlace",components:{LoadingIcon:p},data:function(){var e=A.get("q")||"",t=$();return{enteredInput:e,loading:null,lastCancel:null,suggestionsLoaded:!1,boxInTheMiddle:!0,stillLoading:0,error:null,hideInput:!1,noRoads:!1,clicked:!1,showWarning:t,mainActionText:t?"Download Area":X,suggestions:[]}},watch:{enteredInput:function(){this.mainActionText=X,this.showWarning=!1,this.hideInput=!1,A.unsetPlace()}},mounted:function(){this.$refs.input.focus()},beforeDestroy:function(){this.lastCancel&&this.lastCancel(),clearInterval(this.notifyStillLoading)},methods:{onSubmit:function(){var e=this;A.set("q",this.enteredInput),this.cancelRequest(),this.suggestions=[],this.noRoads=!1,this.error=!1,this.showWarning=!1;var t=$(this.enteredInput);if(t)this.pickSuggestion(t);else{encodeURIComponent(this.enteredInput);this.loading="Searching cities that match your query...",F(this.enteredInput).then((function(t){e.loading=null,e.hideInput=t&&t.length,e.boxInTheMiddle?(e.boxInTheMiddle=!1,setTimeout((function(){e.suggestionsLoaded=!0,e.suggestions=t}),50)):(e.suggestionsLoaded=!0,e.suggestions=t)}))}},getBugReportURL:function(e){var t=encodeURIComponent("OSM Error"),n="";return e&&(n="Hello, an error occurred on the website:\n\n```\n"+e.toString()+"\n```\n\n Can you please help?"),"https://github.com/anvaka/city-roads/issues/new?title=".concat(t,"&body=").concat(encodeURIComponent(n))},updateProgress:function(e){if(this.stillLoading=0,clearInterval(this.notifyStillLoading),e.loaded<0)return this.loading="Trying a different server",void this.restartLoadingMonitor();void 0!==e.percent?this.loading="Loaded "+Math.round(100*e.percent)+"% ("+W(e.loaded)+" bytes)...":this.loading="Loaded "+W(e.loaded)+" bytes..."},retry:function(){this.lastSuggestion&&this.pickSuggestion(this.lastSuggestion)},pickSuggestion:function(e){var t=this;this.lastSuggestion=e,this.error=!1,A.isCacheEnabled()&&e.areaId?this.checkCache(e).catch((function(n){if(!n.cancelled)return t.useOSM(e)})):this.useOSM(e)},restartLoadingMonitor:function(){var e=this;clearInterval(this.notifyStillLoading),this.stillLoading=0,this.notifyStillLoading=setInterval((function(){e.stillLoading++}),1e4)},checkCache:function(e){var t=this;this.loading="Checking cache...";var o=e.areaId;return w(N.areaServer+"/"+o+".pbf",{progress:this.generateNewProgressToken(),responseType:"arraybuffer"}).then((function(e){var t=new Uint8Array(e);return t})).then((function(e){var o=n("7915"),r=n("30c5").place,i=new o(e),a=r.read(i),s=L.fromPBF(a);t.$emit("loaded",s)}))},useOSM:function(e){var t=this;this.loading="Connecting to OpenStreetMap...",this.restartLoadingMonitor(),T.runFromOptions(new D({wayFilter:T.Road,areaId:e.areaId,bbox:e.bbox}),this.generateNewProgressToken()).then((function(n){t.loading=null,n.hasRoads()?(n.setName(e.name),n.setId(e.areaId||e.osm_id),n.setIsArea(e.areaId),n.setBBox(V(e.bbox)),t.$emit("loaded",n)):t.noRoads=!0})).catch((function(e){e.cancelled?t.loading=null:(console.error(e),t.error=e,t.loading=null,t.suggestions=[])})).finally((function(){clearInterval(t.notifyStillLoading),t.stillLoading=0}))},cancelRequest:function(){this.progressToken&&(this.progressToken.cancel(),this.progressToken=null,this.loading=!1)},generateNewProgressToken:function(){return this.progressToken&&(this.progressToken.cancel(),this.progressToken=null),this.progressToken=new y(this.updateProgress),this.progressToken}}};function V(e){return e&&e.join(",")}function W(e){return Number.isFinite(e)?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"N/A"}function $(e){var t=H();if(t)return{name:e,areaId:t};var n=Q();return n?{name:e,osm_id:n.osm_id,bbox:n.bbox}:void 0}function H(){var e=A.get("areaId");return Number.isFinite(Number.parseInt(e,10))||(e=null),e}function Q(){var e=A.get("osm_id");if(Number.isFinite(Number.parseInt(e,10))){var t=J(A.get("bbox"));if(t)return{osm_id:e,bbox:t}}}function J(e){if(!e)return null;var t=e.split(",").map((function(e){return Number.parseFloat(e)})).filter((function(e){return Number.isFinite(e)}));return 4===t.length?t:null}var K,Z=Y,ee=(n("46e8"),Object(d["a"])(Z,s,c,!1,null,null,null)),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.looseFocus,expression:"looseFocus"}],staticClass:"can-drag"},[n("div",{staticClass:"editable-label"},[n("span",{class:{printable:e.printable}},[e._v(e._s(e.value))]),n("input",{ref:"input",domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})])])},oe=[],re=(n("a434"),[]),ie="@@clickoutsideContext",ae=0;function se(e,t,n){return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n&&n.context&&o.target&&r.target&&!e.contains(o.target)&&!e.contains(r.target)&&e!==o.target&&(!n.context.popperElm||!n.context.popperElm.contains(o.target)&&!n.context.popperElm.contains(r.target))){var i=e[ie].methodName;t.expression&&i&&n.context[i]?n.context[i]():e[ie].bindingFn&&e[ie].bindingFn()}}}document.addEventListener("mousedown",(function(e){return K=e}),!0),document.addEventListener("mouseup",(function(e){re.forEach((function(t){return t[ie].documentHandler(e,K)}))}),!0),document.addEventListener("touchstart",(function(e){K=e}),!0),document.addEventListener("touchend",(function(e){re.forEach((function(t){return t[ie].documentHandler(e,K)}))}),!0);var ce={bind:function(e,t,n){re.push(e);var o=ae++;e[ie]={id:o,documentHandler:se(e,t,n),methodName:t.expression,bindingFn:t.value}},update:function(e,t,n){e[ie].documentHandler=se(e,t,n),e[ie].methodName=t.expression,e[ie].bindingFn=t.value},unbind:function(e){for(var t=re.length,n=0;n<t;n++)if(re[n][ie].id===e[ie].id){re.splice(n,1);break}delete e[ie]}},ue={name:"EditableLabel",props:["value","printable","overlayManager"],directives:{ClickOutside:ce},mounted:function(){this.$el.receiveFocus=this.focus,this.$el.style.pointerEvents="none"},methods:{looseFocus:function(){this.$refs.input.blur()},focus:function(){this.$refs.input.focus()}}},le=ue,de=(n("9b59"),Object(d["a"])(le,ne,oe,!1,null,null,null)),he=de.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.hide,expression:"hide"}],staticClass:"vue-colorpicker",on:{click:function(t){e.showPicker=!0}}},[n("span",{ref:"triggerButton",staticClass:"vue-colorpicker-btn",style:e.btnStyle}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPicker,expression:"showPicker"}],staticClass:"vue-colorpicker-panel",style:{left:e.panelLeft,top:e.panelTop}},[n(e.pickerType,{tag:"component",on:{input:e.changeColor},model:{value:e.colors,callback:function(t){e.colors=t},expression:"colors"}})],1)])},pe=[],ge=n("c345"),ve={name:"vue-colorpicker",components:{"sketch-picker":ge["Sketch"]},directives:{ClickOutside:ce},props:{value:{type:Object}},data:function(){return{showPicker:!1,colors:{hex:"#FFFFFF",a:1},colorValue:"#FFFFFF",panelLeft:"0px",panelTop:"0px"}},computed:{pickerType:function(){return"sketch-picker"},isTransparent:function(){return 0===this.colors.a},btnStyle:function(){if(this.isTransparent)return{background:"#eee",backgroundImage:"linear-gradient(45deg, rgba(0,0,0,.25) 25%, transparent 0, transparent 75%,rgba(0,0,0,.25)0), linear-gradient(45deg, rgba(0,0,0,.25)25%,transparent 0, transparent 75%,rgba(0,0,0,.25)0)",backgroundPosition:"0 0, 11px 11px",backgroundSize:"22px 22px"};var e=this.colorValue,t=e.r,n=e.g,o=e.b,r=e.a;return{background:"rgba(".concat(t,", ").concat(n,", ").concat(o,", ").concat(r,")")}}},watch:{value:function(e,t){e!==t&&this.updateColorObject(e)},showPicker:function(e){if(e){var t=220,n=320,o=this.$refs.triggerButton.getBoundingClientRect(),r=o.x,i=o.bottom;o.y+n>window.innerHeight&&(i=Math.max(0,window.innerHeight-n),r+=36),r+t>window.innerWidth&&(r=Math.max(0,window.innerWidth-t)),this.panelLeft=r+"px",this.panelTop=i+"px"}}},methods:{hide:function(){this.showPicker=!1},changeColor:function(e){this.colorValue=e.rgba,this.$emit("input",this.colorValue),this.$emit("change",this.colorValue)},updateColorObject:function(e){if(e){var t=q()(e);this.colors=e&&"transparent"!==e?{hex:t.toHexString(),hsl:t.toHsl(),hsv:t.toHsv(),rgba:t.toRgb(),a:t.getAlpha()}:{hex:"#FFFFFF",hsl:{h:0,s:0,l:1,a:0},hsv:{h:0,s:0,v:1,a:0},rgba:{r:255,g:255,b:255,a:0},a:0},this.colorValue=this.colors.rgba}}},mounted:function(){this.updateColorObject(this.value)}},me=ve,be=(n("cd97"),Object(d["a"])(me,fe,pe,!1,null,"a5fc1b7c",null)),ye=be.exports,we=b()({}),ke=n("c500"),xe=0,_e=function(){function e(){Object(a["a"])(this,e),this._color=N.getDefaultLineColor(),this.grid=null,this.lines=null,this.scene=null,this.dx=0,this.dy=0,this.scale=1,this.hidden=!1,this.id="paths_"+xe,this._lineWidth=1,xe+=1}return Object(g["a"])(e,[{key:"color",get:function(){return this._color},set:function(e){var t=q()(e);this._color=t,this.lines&&(this.lines.color=Ce(t.toRgb())),this.scene&&this.scene.renderFrame()}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(e){this._lineWidth=e,this.lines&&this.scene&&this.lines.setLineWidth(e)}},{key:"getGridProjector",value:function(){if(this.grid)return this.grid.projector}},{key:"getQueryBounds",value:function(){var e=this.grid;if(e){if(e.queryBounds)return e.queryBounds;if(e.isArea)return{areaId:e.id}}}},{key:"setGrid",value:function(e){this.grid=e,this.scene&&this.bindToScene(this.scene)}},{key:"getViewBox",value:function(){if(!this.grid)return null;var e=this.grid.getProjectedRect(),t=e.width,n=e.height,o=Math.max(t,n)/4;return{left:-o,top:o,right:o,bottom:-o}}},{key:"moveTo",value:function(e){console.warn("Please use moveBy() instead. The moveTo() is under construction")}},{key:"moveBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.dx=e,this.dy=t,this._transferTransform()}},{key:"buildLinesCollection",value:function(){if(this.lines)return this.lines;var e=this.grid,t=new ke.WireCollection(e.wayPointCount,{width:this._lineWidth,allowColors:!1,is3D:!1});e.forEachWay((function(e,n){t.add({from:e,to:n})}));var n=q()(this._color).toRgb();t.color=Ce(n),t.id=this.id,this.lines=t}},{key:"destroy",value:function(){this.scene&&this.lines&&this.scene.removeChild(this.lines)}},{key:"bindToScene",value:function(e){this.scene&&this.lines&&console.error("You seem to be adding this layer twice..."),this.scene=e,this.grid&&(this.buildLinesCollection(),this.hidden||this.scene.appendChild(this.lines))}},{key:"hide",value:function(){this.hidden||(this.hidden=!0,this.scene&&this.grid&&this.scene.removeChild(this.lines))}},{key:"show",value:function(){this.hidden&&(this.hidden=!1,this.scene&&this.grid?this.scene.appendChild(this.lines):console.log("Layer will be shown when grid is available"))}},{key:"_transferTransform",value:function(){this.lines&&(this.lines.translate([this.dx,this.dy,0]),this.lines.updateWorldTransform(!0),this.scene&&this.scene.renderFrame(!0))}}]),e}();function Ce(e){return{r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}}var Le=n("5530"),Se=(n("2b3d"),n("a630"),n("816e"),n("4057"),n("30c5").place,n("c500"));function Fe(e,t){var n=e.getRenderer(),o={open:function(){return"\x3c!-- Generator: https://github.com/anvaka/city-roads\nData © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright\n--\x3e"},close:function(){return i()}};t.minLength&&(o.beforeWrite=function(e){for(var n=0,o=1;o<e.length;++o)if(n+=Math.hypot(e[o].x-e[o-1].x,e[o].y-e[o-1].y),n>t.minLength)return!0;return n>t.minLength}),o.round=t.round;var r=Se.toSVG(n,o);return r;function i(){var e=n.getPixelRatio();return t.printable.map((function(t){if(t.element instanceof SVGSVGElement){var n=t.bounds,o=(n.left,n.top,t.element);o.setAttribute("x",n.left*e),o.setAttribute("y",n.top*e),o.setAttribute("width",n.width*e),o.setAttribute("height",n.height*e);var r=(new XMLSerializer).serializeToString(t.element);return o.removeAttribute("x"),o.removeAttribute("y"),o.removeAttribute("width"),o.removeAttribute("height"),r}var i=t;if(i.text){var a=i.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s=i.bounds,c=(s.right-i.paddingRight)*e,u=(s.bottom-i.paddingBottom)*e,l=i.fontSize*e,d=i.fontFamily.replace(/"/g,"'");return'<text text-anchor="end" x="'.concat(c,'" y="').concat(u,'" fill="').concat(i.color,'" font-family="').concat(d,'" font-size="').concat(l,'">').concat(a,"</text>")}})).filter((function(e){return e})).join("\n")}}function Ee(e,t){t=t||{};var n=Fe(e,Object(Le["a"])({printable:Re()},t)),o=new Blob([n],{type:"image/svg+xml"}),r=window.URL.createObjectURL(o),i=Oe(t.name,".svg");setTimeout((function(){var e=document.createElement("a");e.href=r,e.download=i,e.click(),ze(r)}),30)}function Te(e,t){t=t||{},Pe(e).then((function(e){var n=Oe(t.name,".png");e.toBlob((function(e){var t=window.URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download=n,o.click(),ze(t)}),"image/png")}))}function Pe(e){var t=Ie(),n=t.width,o=t.height,r=document.createElement("canvas"),i=r.getContext("2d");return r.width=n,r.height=o,e.render(),i.drawImage(t,0,0,t.width,t.height,0,0,n,o),Promise.all(Re().map((function(e){return Be(e,i)}))).then((function(){return r}))}function Ie(){return document.querySelector("#canvas")}function Oe(e,t){var n=je(e||(new Date).toISOString());return n+(t||"")}function je(e){return e?e.replace(/[#%&{}\\/?*><$!'":@+`|=]/g,"_"):""}function Be(e,t){return e?new Promise((function(n,o){var r=window.devicePixelRatio||1;if(e.element instanceof SVGSVGElement){var i=e.element,a=e.bounds,s=new Image;s.width=a.width*r,s.height=a.height*r,s.onload=function(){t.drawImage(s,a.left*r,a.top*r,s.width,s.height),i.removeAttribute("width"),i.removeAttribute("height"),n()},i.setAttribute("width",s.width),i.setAttribute("height",s.height),s.src="data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(i))}else t.save(),t.font=r*e.fontSize+"px "+e.fontFamily,t.fillStyle=e.color,t.textAlign="end",t.fillText(e.text,(e.bounds.right-e.paddingRight)*r,(e.bounds.bottom-e.paddingBottom)*r),t.restore(),n()})):Promise.resolve()}function Re(){return Array.from(document.querySelectorAll(".printable")).map((function(e){var t=window.getComputedStyle(e),n=e.getBoundingClientRect(),o=Number.parseInt(t.fontSize,10),r=Number.parseInt(t.paddingRight,10),i=2*Number.parseInt(t.paddingBottom,10);return{text:e.innerText,bounds:n,fontSize:o,paddingBottom:i,paddingRight:r,color:t.color,fontFamily:t.fontFamily,fill:t.color,element:e}}))}function ze(e){setTimeout((function(){window.URL.revokeObjectURL(e)}),45e3)}var Ae=n("c500");function Me(e){var t=Ae.createScene(e),n=N.getDefaultLineColor();t.on("transform",g),t.on("append-child",v),t.on("remove-child",m),t.setClearColor(247/255,242/255,232/255,1);var o=t.getCamera();o.setMoveSpeed&&(o.setMoveSpeed(200),o.setRotationSpeed(Math.PI/500));var r=t.getGL();r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);var i=!1,a=[],s=N.getBackgroundColor();y();var c={render:function(){t.renderFrame(!0)},clear:function(){a.forEach((function(e){return e.destroy()})),a=[],t.clear()},queryLayerAll:l,queryLayer:d,getRenderer:function(){return t},getWGL:function(){return Ae},version:function(){return"0.0.2"},dispose:function(){t.clear(),t.dispose(),c.fire("dispose",c),w()},set lineColor(e){a.forEach((function(t){t.color=e})),n=q()(e),we.fire("line-color",n),c.fire("line-color",n)},get lineColor(){var e=d();return e&&e.color||n},set background(e){s=q()(e);var n=s.toRgb();t.setClearColor(n.r/255,n.g/255,n.b/255,n.a),t.renderFrame(),we.fire("background-color",s),c.fire("background-color",s)},get background(){return s},add:h,load:u,saveToPNG:f,saveToSVG:p};return b()(c);function u(e,t){var n=D.parse(c,e,t),o=new _e;return o.id=n.place,T.runFromOptions(n).then((function(e){e.setProjector(n.projector),o.setGrid(e)})).catch((function(t){console.error("Could not execute:\n  ".concat(e,"\n  The error was:")),console.error(t),o.destroy()})),h(o),o}function l(e){return e?a.filter((function(t){return t.id===e})):a}function d(e){var t=l(e);if(t)return t[0]}function h(e){if(!(a.indexOf(e)>-1)&&(e.bindToScene(t),a.push(e),1===a.length)){var n=e.getViewBox();n&&t.setViewBox(n)}}function f(e){return Te(c,{name:e})}function p(e,t){return Ee(c,Object.assign({},{name:e},t))}function g(e){we.fire("scene-transform")}function v(e){c.fire("layer-added",e)}function m(e){c.fire("layer-removed",e)}function y(){document.addEventListener("keydown",k,!0),document.addEventListener("keyup",x,!0)}function w(){document.removeEventListener("keydown",k,!0),document.removeEventListener("keyup",x,!0)}function k(e){e.shiftKey&&(i=!0,o.setSpeed&&o.setSpeed(.1))}function x(e){!e.shiftKey&&i&&(o.setSpeed&&o.setSpeed(1),i=!1)}}n("9911");var qe="https://edi6jgnosf.execute-api.us-west-2.amazonaws.com/Stage/put_image",Ne={mug:"168739066664861503"};function De(e,t){var n=Ne[e];if(!n)throw new Error("Unknown product kind: "+e);var o=encodeURIComponent(t);return"https://www.zazzle.com/api/create/at-238058511445368984?rf=238058511445368984&ax=Linkover&pd=".concat(n,"&ed=true&tc=&ic=&t_map_iid=").concat(o)}function Ge(e){var t=e.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,""),n=new FormData;return n.append("image",t),w(qe,{method:"POST",responseType:"json",progress:new y(Function.prototype),body:n},"POST").then((function(e){if(!e.success)throw new Error("Failed to upload image");var t=e.data.link;return De("mug",t)})).catch((function(e){throw console.log("error",e),e}))}n("9406");function Ue(){var e,t={clickedElement:null,x:0,y:0,time:Date.now(),left:0,right:0};return document.addEventListener("mousedown",o),document.addEventListener("mouseup",i),document.addEventListener("touchstart",a,{passive:!1,capture:!0}),document.addEventListener("touchend",s,!0),document.addEventListener("touchcancel",s,!0),{track:w,dispose:k,clear:n};function n(){for(var e=document.querySelectorAll(".overlay-active"),t=0;t<e.length;++t)v(e[t])}function o(e){u(e.clientX,e.clientY,e)}function r(e){d(e.clientX,e.clientY)}function i(e){l(e.clientX,e.clientY)}function a(e){if(!(e.touches.length>1)){var t=e.touches[0];u(t.clientX,t.clientY,e)}}function s(e){if(!(e.changedTouches.length>1)){var t=e.changedTouches[0],n=l(t.clientX,t.clientY);n&&(e.preventDefault(),e.stopPropagation())}}function c(e){if(!(e.touches.length>1)){var t=e.touches[0];d(t.clientX,t.clientY),e.preventDefault(),e.stopPropagation()}}function u(e,o,r){for(var i=g(e,o),a=document.querySelectorAll(".overlay-active"),s=0;s<a.length;++s){var c=a[s];c!==i&&v(c)}1===a.length&&(t.clickedElement=a[0]);var u=i&&i===t.clickedElement;u&&(t.clickedElement.contains(r.target)||(i=null,u=!1));var l=u&&!i.classList.contains("exclusive");if(l?(h(),r.preventDefault(),r.stopPropagation()):t.clickedElement=i,t.x=e,t.y=o,t.time=Date.now(),i){var d=i.getBoundingClientRect();t.dx=d.right-t.x,t.dy=d.bottom-t.y}else n()}function l(e,n){if(t.clickedElement){if(f(),p(e,n))return m(t.clickedElement,e,n),!0;t.clickedElement=null}}function d(e,n){if(t.clickedElement){var o=t.clickedElement.style;o.right=100*(window.innerWidth-e-t.dx)/window.innerWidth+"%",o.bottom=100*(window.innerHeight-n-t.dy)/window.innerHeight+"%"}}function h(){f(),e=document.createElement("div"),e.classList.add("drag-overlay"),document.body.appendChild(e),document.addEventListener("mousemove",r,!0),document.addEventListener("touchmove",c,{passive:!1,capture:!0})}function f(){e&&(document.body.removeChild(e),e=null),document.removeEventListener("mousemove",r,!0),document.removeEventListener("touchmove",c,{passive:!1,capture:!0})}function p(e,n){var o=Date.now()-t.time;return!(o>300)&&Math.hypot(e-t.x,n-t.y)<40}function g(e,t){for(var n=document.querySelectorAll(".can-drag"),o=0;o<n.length;++o){var r=n[o],i=y(r);if(b(e,t,i))return r}}function v(e){e.style.pointerEvents="none",e.classList.remove("overlay-active"),e.classList.remove("exclusive")}function m(e,t,n){e&&(e.style.pointerEvents="",e.classList.contains("overlay-active")?(e.receiveFocus&&e.receiveFocus(),e.classList.add("exclusive")):(e.classList.add("overlay-active"),e.classList.contains("can-resize")))}function b(e,t,n){return!(e<n.left||e>n.right||t<n.top||t>n.bottom)}function y(e){return e.getBoundingClientRect()}function w(e,t){e.style.pointerEvents="none",e.classList.add("can-drag"),t&&t.receiveFocus&&(e.receiveFocus=t.receiveFocus)}function k(){document.removeEventListener("mousedown",o),document.removeEventListener("mouseup",i),document.removeEventListener("touchstart",a),document.removeEventListener("touchend",s),document.removeEventListener("touchcancel",s),t.clickedElement=void 0,f()}}var Xe=function e(t,n,o){Object(a["a"])(this,e),this.name=t,this.changeColor=o,this.color=n},Ye={name:"App",components:{FindPlace:te,LoadingIcon:p,EditableLabel:he,ColorPicker:ye},data:function(){return{placeFound:!1,name:"",zazzleLink:null,generatingPreview:!1,showSettings:!1,settingsOpen:!1,labelColor:N.getLabelColor().toRgb(),backgroundColor:N.getBackgroundColor().toRgb(),layers:[]}},computed:{labelColorRGBA:function(){return Ve(this.labelColor)}},created:function(){we.on("scene-transform",this.handleSceneTransform),we.on("background-color",this.syncBackground),we.on("line-color",this.syncLineColor),this.overlayManager=Ue()},beforeDestroy:function(){this.overlayManager.dispose(),this.dispose(),we.off("scene-transform",this.handleSceneTransform),we.off("background-color",this.syncBackground),we.off("line-color",this.syncLineColor)},methods:{dispose:function(){this.scene&&(this.scene.dispose(),window.scene=null)},toggleSettings:function(){this.showSettings=!this.showSettings},handleSceneTransform:function(){this.zazzleLink=null},onGridLoaded:function(e){e.isArea?(A.set("areaId",e.id),A.unset("osm_id"),A.unset("bbox")):e.bboxString&&(A.unset("areaId"),A.set("osm_id",e.id),A.set("bbox",e.bboxString)),this.placeFound=!0,this.name=e.name.split(",")[0];var t=Ie();t.style.visibility="visible",this.scene=Me(t),this.scene.on("layer-added",this.updateLayers),this.scene.on("layer-removed",this.updateLayers),window.scene=this.scene;var n=new _e;n.id="lines",n.setGrid(e),this.scene.add(n)},startOver:function(){A.unset("areaId"),A.unsetPlace(),A.unset("q"),A.enableCache(),this.dispose(),this.placeFound=!1,this.zazzleLink=null,this.showSettings=!1,this.backgroundColor=N.getBackgroundColor().toRgb(),this.labelColor=N.getLabelColor().toRgb(),document.body.style.backgroundColor=N.getBackgroundColor().toRgbString(),Ie().style.visibility="hidden"},toPNGFile:function(e){scene.saveToPNG(this.name)},toSVGFile:function(e){scene.saveToSVG(this.name)},updateLayers:function(){var e=this,t=[],n=0,o=this.scene.getRenderer(),r=o.getRoot();function i(e){return{r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}}r.children.forEach((function(r){if(r.color){var a=r.id;a||(n+=1,a="lines "+n);var s=q.a.fromRatio(r.color);t.push(new Xe(a,s,(function(t){e.zazzleLink=null,r.color=i(t),o.renderFrame(),e.scene.fire("color-change",r)})))}})),t.push(new Xe("background",this.backgroundColor,this.setBackgroundColor),new Xe("labels",this.labelColor,(function(t){return e.labelColor=t}))),this.layers=t,this.zazzleLink=null},syncLineColor:function(){this.updateLayers()},syncBackground:function(e){this.backgroundColor=e.toRgb(),this.updateLayers()},updateBackground:function(){this.setBackgroundColor(this.backgroundColor),this.zazzleLink=null},setBackgroundColor:function(e){this.scene.background=e,document.body.style.backgroundColor=Ve(e),this.zazzleLink=null},zazzleMugPrint:function(){var e=this;if(this.zazzleLink)return window.open(this.zazzleLink,"_blank"),void We(this.zazzleLink);this.generatingPreview=!0,Pe(this.scene).then((function(t){Ge(t).then((function(t){e.zazzleLink=t,window.open(t,"_blank"),We(t),e.generatingPreview=!1})).catch((function(t){e.error=t,e.generatingPreview=!1}))}))}}};function Ve(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")}function We(e){"undefined"!==typeof ga&&ga("send","event",{eventCategory:"Outbound Link",eventAction:"click",eventLabel:e})}var $e=Ye,He=(n("7faf"),Object(d["a"])($e,r,i,!1,null,null,null)),Qe=He.exports,Je=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Ke=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute no-webgl"},[n("h3",[e._v("WebGL is not enabled :(")]),n("p",[e._v("This website renders millions of roads at once.")]),n("p",[e._v(" To render this amount of data fast, the website uses "),n("a",{attrs:{href:"https://get.webgl.org/"}},[e._v("WebGL")]),e._v(", which seem to be not supported by the device that you are using. ")]),n("p",[e._v("Please try a different device to play with this website")]),n("img",{attrs:{src:"https://i.imgur.com/Fbbe5a6.png",alt:"demo"}})])}],Ze=(n("bfab"),{}),et=Object(d["a"])(Ze,Je,Ke,!1,null,"3c40a512",null),tt=et.exports,nt=n("1a2f"),ot=n("c500");function rt(e){if("function"===typeof ga){var t=e?"".concat(e.message," in ").concat(e.filename,":").concat(e.lineno):"Unknown exception";ga("send","exception",{exDescription:t,exFatal:!1})}}window.addEventListener("error",rt),o["a"].config.productionTip=!1,window.requireModule=nt["a"],window.Query=T,ot.isWebGLEnabled(document.querySelector("#canvas"))?new o["a"]({render:function(e){return e(Qe)}}).$mount("#app"):new o["a"]({render:function(e){return e(tt)}}).$mount("#app")},"5c3e":function(e,t,n){},"7faf":function(e,t,n){"use strict";n("b8ff")},"816e":function(e,t,n){n("b0c0");var o=n("7915"),r=n("30c5").place;e.exports=function(e){var t=[],n=[],i=(new Date).toISOString();e.forEachElement((function(e){"node"===e.type?t.push(e):"way"===e.type&&n.push(e)}));var a=new o;return r.write({version:1,id:e.id,date:i,name:e.name,nodes:t,ways:n},a),a.finish()}},"93cf":function(e,t,n){},9406:function(e,t,n){var o;n("7037").default;n("ace4"),n("d3b7"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("c19f"),n("ac1f"),n("466d"),n("fb6a"),function(r){"use strict";var i=r.HTMLCanvasElement&&r.HTMLCanvasElement.prototype,a=r.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),s=a&&r.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),c=r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,u=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,l=(a||c)&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&function(e){var t,n,o,r,i,l,d,h,f;if(t=e.match(u),!t)throw new Error("invalid data URI");for(n=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),o=!!t[4],r=e.slice(t[0].length),i=o?atob(r):decodeURIComponent(r),l=new ArrayBuffer(i.length),d=new Uint8Array(l),h=0;h<i.length;h+=1)d[h]=i.charCodeAt(h);return a?new Blob([s?d:l],{type:n}):(f=new c,f.append(l),f.getBlob(n))};r.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(e,t,n){var o=this;setTimeout((function(){n&&i.toDataURL&&l?e(l(o.toDataURL(t,n))):e(o.mozGetAsFile("blob",t))}))}:i.toDataURL&&l&&(i.toBlob=function(e,t,n){var o=this;setTimeout((function(){e(l(o.toDataURL(t,n)))}))})),o=function(){return l}.call(t,n,t,e),void 0===o||(e.exports=o)}(window)},"9b59":function(e,t,n){"use strict";n("20fa")},b8ff:function(e,t,n){},bfab:function(e,t,n){"use strict";n("4eab")},cd97:function(e,t,n){"use strict";n("5c3e")}});
//# sourceMappingURL=app.db404a92.js.map